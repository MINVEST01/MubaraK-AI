#!/bin/bash

# =================================================================
# == –°–∫—Ä–∏–ø—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ Alembic –≤ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ ==
# =================================================================
#
# –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç —è–≤–ª—è–µ—Ç—Å—è —É–¥–æ–±–Ω–æ–π –æ–±–µ—Ä—Ç–∫–æ–π –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥ alembic
# –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ä–≤–∏—Å–∞ 'web'.
#
# –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
# ./scripts/migrate.sh upgrade head                # –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏
# ./scripts/migrate.sh revision --autogenerate -m "create users"  # –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Ä–µ–≤–∏–∑–∏—é
# ./scripts/migrate.sh downgrade -1                # –û—Ç–∫–∞—Ç–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –º–∏–≥—Ä–∞—Ü–∏—é

set -e # –ü—Ä–µ–∫—Ä–∞—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–∏ –ª—é–±–æ–π –æ—à–∏–±–∫–µ

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å docker-compose —Ñ–∞–π–ª–∞–º–∏
cd "$(dirname "$0")/../docker"

echo "üöÄ –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã: alembic $@"
docker-compose exec web alembic "$@"